<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>데이터마이닝 기법과 응용: R 예제 - 2장 회귀분석</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/ch03_regularized_regression.html" rel="next">
<link href="../index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/ch02_regression.html">예측</a></li><li class="breadcrumb-item"><a href="../chapters/ch02_regression.html"><span class="chapter-title">2장 회귀분석</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">데이터마이닝 기법과 응용: R 예제</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/youngroklee-ml/data-mining-techniques" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">소개</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">예측</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch02_regression.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">2장 회귀분석</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch03_regularized_regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3장 규제 회귀분석</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">분류분석</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch05_classification.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5장 분류분석 개요</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch06_logistic_regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6장 로지스틱 회귀분석</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch07_da.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">7장 판별분석</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch09_svm.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">9장 서포트 벡터 머신</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">군집분석</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch11_cluster.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">11장 군집분석 개요</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch12_cluster.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">12장 계층적 군집방법</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch13_cluster_dbscan.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">13장 비계층적 군집방법</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">연관규칙</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch15_association_rule.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">15장 연관규칙</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ch16_recommender_system.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">16장 추천시스템</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#예-2.3---2.5-2.7-2.10---2.11" id="toc-예-2.3---2.5-2.7-2.10---2.11" class="nav-link active" data-scroll-target="#예-2.3---2.5-2.7-2.10---2.11">(예 2.3 - 2.5, 2.7, 2.10 - 2.11)</a></li>
  <li><a href="#예-2.8---2.9-2.13" id="toc-예-2.8---2.9-2.13" class="nav-link" data-scroll-target="#예-2.8---2.9-2.13">(예 2.8 - 2.9, 2.13)</a></li>
  <li><a href="#예-2.14-2.16" id="toc-예-2.14-2.16" class="nav-link" data-scroll-target="#예-2.14-2.16">(예 2.14, 2.16)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/ch02_regression.html">예측</a></li><li class="breadcrumb-item"><a href="../chapters/ch02_regression.html"><span class="chapter-title">2장 회귀분석</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">2장 회귀분석</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="예-2.3---2.5-2.7-2.10---2.11" class="level2">
<h2 class="anchored" data-anchor-id="예-2.3---2.5-2.7-2.10---2.11">(예 2.3 - 2.5, 2.7, 2.10 - 2.11)</h2>
<section id="데이터-로드" class="level4">
<h4 class="anchored" data-anchor-id="데이터-로드">데이터 로드</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/ch2_reg1.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="예-2.3-회귀계수-추정" class="level4">
<h4 class="anchored" data-anchor-id="예-2.3-회귀계수-추정">(예 2.3) 회귀계수 추정</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> age <span class="sc">+</span> height, <span class="at">data =</span> dat1)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)          age       height 
-108.1671993    0.3291212    0.9552913 </code></pre>
</div>
</div>
</section>
<section id="예-2.4-오차항-분산-추정" class="level4">
<h4 class="anchored" data-anchor-id="예-2.4-오차항-분산-추정">(예 2.4) 오차항 분산 추정</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(lm_fit<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> lm_fit<span class="sc">$</span>df.residual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.038464</code></pre>
</div>
</div>
</section>
<section id="예-2.5-회귀성검정" class="level4">
<h4 class="anchored" data-anchor-id="예-2.5-회귀성검정">(예 2.5) 회귀성검정</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: weight
          Df  Sum Sq Mean Sq F value   Pr(&gt;F)   
age        1 119.299 119.299   16.95 0.004476 **
height     1 107.831 107.831   15.32 0.005793 **
Residuals  7  49.269   7.038                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="예-2.7-회귀계수검정" class="level4">
<h4 class="anchored" data-anchor-id="예-2.7-회귀계수검정">(예 2.7) 회귀계수검정</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ age + height, data = dat1)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.3398 -1.6623 -0.3084  1.3727  4.1911 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) -108.16720   42.12277  -2.568  0.03712 * 
age            0.32912    0.06924   4.753  0.00208 **
height         0.95529    0.24406   3.914  0.00579 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.653 on 7 degrees of freedom
Multiple R-squared:  0.8217,    Adjusted R-squared:  0.7708 
F-statistic: 16.13 on 2 and 7 DF,  p-value: 0.002391</code></pre>
</div>
</div>
</section>
<section id="예-2.10-평균반응치-추정" class="level4">
<h4 class="anchored" data-anchor-id="예-2.10-평균반응치-추정">(예 2.10) 평균반응치 추정</h4>
<p>추정회귀계수벡터의 분산-공분산 행렬</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(lm_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             (Intercept)          age        height
(Intercept) 1774.3280624 -0.671107283 -10.264885141
age           -0.6711073  0.004794717   0.003035476
height       -10.2648851  0.003035476   0.059566804</code></pre>
</div>
</div>
<p>신규 데이터</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">40</span>, <span class="at">height =</span> <span class="dv">170</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>신규 데이터에 대한 평균반응치 추정</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm_fit, newdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
67.39718 </code></pre>
</div>
</div>
<p>신규 데이터에 대한 평균반응치의 95% 신뢰구간</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>conf_interval <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit, newdata, <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>conf_interval[, <span class="fu">c</span>(<span class="st">"lwr"</span>, <span class="st">"upr"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     lwr      upr 
65.01701 69.77735 </code></pre>
</div>
</div>
</section>
<section id="예-2.11-미래반응치-예측" class="level4">
<h4 class="anchored" data-anchor-id="예-2.11-미래반응치-예측">(예 2.11) 미래반응치 예측</h4>
<p>신규 데이터에 대한 미래반응치의 95% 예측구간</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pred_interval <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit, newdata, <span class="at">interval =</span> <span class="st">"prediction"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>pred_interval[, <span class="fu">c</span>(<span class="st">"lwr"</span>, <span class="st">"upr"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     lwr      upr 
60.68745 74.10690 </code></pre>
</div>
</div>
</section>
</section>
<section id="예-2.8---2.9-2.13" class="level2">
<h2 class="anchored" data-anchor-id="예-2.8---2.9-2.13">(예 2.8 - 2.9, 2.13)</h2>
<section id="패키지-로드" class="level4">
<h4 class="anchored" data-anchor-id="패키지-로드">패키지 로드</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"olsrr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'olsrr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:datasets':

    rivers</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"car"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
</div>
</section>
<section id="데이터-로드-1" class="level4">
<h4 class="anchored" data-anchor-id="데이터-로드-1">데이터 로드</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dat_ba <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/Player.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="다중-회귀모형-추정" class="level4">
<h4 class="anchored" data-anchor-id="다중-회귀모형-추정">다중 회귀모형 추정</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Salary <span class="sc">~</span> Hits <span class="sc">+</span> Walks <span class="sc">+</span> CRuns <span class="sc">+</span> HmRun <span class="sc">+</span> CWalks, <span class="at">data =</span> dat_ba)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ Hits + Walks + CRuns + HmRun + CWalks, 
    data = dat_ba)

Residuals:
    Min      1Q  Median      3Q     Max 
-858.19 -184.25  -40.46  120.95 2183.89 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -61.7447    57.0968  -1.081  0.28053    
Hits          1.3558     0.7568   1.791  0.07441 .  
Walks         4.9172     1.5771   3.118  0.00203 ** 
CRuns         1.0212     0.2123   4.810 2.58e-06 ***
HmRun         2.5378     2.9132   0.871  0.38450    
CWalks       -0.5726     0.2821  -2.030  0.04342 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 341.1 on 257 degrees of freedom
  (59 observations deleted due to missingness)
Multiple R-squared:  0.4391,    Adjusted R-squared:  0.4282 
F-statistic: 40.24 on 5 and 257 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="예-2.8-모든-가능한-조합의-회귀분석" class="level4">
<h4 class="anchored" data-anchor-id="예-2.8-모든-가능한-조합의-회귀분석">(예 2.8) 모든 가능한 조합의 회귀분석</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">ols_step_all_possible</span>(lm_model)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>k</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Index N                    Predictors  R-Square Adj. R-Square Mallow's Cp
3      1 1                         CRuns 0.3166062     0.3139878   54.140213
5      2 1                        CWalks 0.2399256     0.2370135   89.276284
2      3 1                         Walks 0.1970181     0.1939416  108.937069
1      4 1                          Hits 0.1924355     0.1893414  111.036886
4      5 1                         HmRun 0.1176683     0.1142877  145.296250
7      6 2                    Hits CRuns 0.4147791     0.4102774   11.156078
10     7 2                   Walks CRuns 0.3906078     0.3859201   22.231709
9      8 2                   Hits CWalks 0.3853422     0.3806140   24.644480
13     9 2                   CRuns HmRun 0.3584707     0.3535358   36.957357
14    10 2                  CRuns CWalks 0.3240582     0.3188586   52.725631
12    11 2                  Walks CWalks 0.3068498     0.3015179   60.610716
15    12 2                  HmRun CWalks 0.2965559     0.2911448   65.327521
6     13 2                    Hits Walks 0.2453786     0.2395738   88.777655
11    14 2                   Walks HmRun 0.2240202     0.2180511   98.564374
8     15 2                    Hits HmRun 0.2093560     0.2032741  105.283718
16    16 3              Hits Walks CRuns 0.4287269     0.4221098    6.765004
23    17 3            Walks CRuns CWalks 0.4269906     0.4203535    7.560585
19    18 3              Hits CRuns HmRun 0.4178491     0.4111061   11.749353
20    19 3             Hits CRuns CWalks 0.4147802     0.4080016   13.155578
22    20 3             Walks CRuns HmRun 0.4021021     0.3951766   18.964848
21    21 3             Hits HmRun CWalks 0.3874947     0.3804000   25.658175
18    22 3             Hits Walks CWalks 0.3868621     0.3797601   25.948023
25    23 3            CRuns HmRun CWalks 0.3647553     0.3573973   36.077637
24    24 3            Walks HmRun CWalks 0.3290179     0.3212459   52.452998
17    25 3              Hits Walks HmRun 0.2532017     0.2445515   87.193024
27    26 4       Hits Walks CRuns CWalks 0.4374699     0.4287485    4.758862
30    27 4      Walks CRuns HmRun CWalks 0.4321227     0.4233184    7.209002
26    28 4        Hits Walks CRuns HmRun 0.4301353     0.4213001    8.119679
29    29 4       Hits CRuns HmRun CWalks 0.4179107     0.4088860   13.721142
28    30 4       Hits Walks HmRun CWalks 0.3886385     0.3791600   27.134046
31    31 5 Hits Walks CRuns HmRun CWalks 0.4391260     0.4282141    6.000000</code></pre>
</div>
</div>
</section>
<section id="예-2.9-단계별방법" class="level4">
<h4 class="anchored" data-anchor-id="예-2.9-단계별방법">(예 2.9) 단계별방법</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_both_p</span>(lm_model, <span class="at">details =</span> <span class="cn">TRUE</span>, <span class="at">pent =</span> <span class="fl">0.3</span>, <span class="at">prem =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stepwise Selection Method   
---------------------------

Candidate Terms: 

1. Hits 
2. Walks 
3. CRuns 
4. HmRun 
5. CWalks 

We are selecting variables based on p value...


Stepwise Selection: Step 1 

- CRuns added 

                          Model Summary                            
------------------------------------------------------------------
R                       0.563       RMSE                  373.643 
R-Squared               0.317       Coef. Var              69.719 
Adj. R-Squared          0.314       MSE                139609.007 
Pred R-Squared          0.295       MAE                   260.516 
------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                   ANOVA                                    
---------------------------------------------------------------------------
                    Sum of                                                 
                   Squares         DF     Mean Square       F         Sig. 
---------------------------------------------------------------------------
Regression    16881162.032          1    16881162.032    120.917    0.0000 
Residual      36437950.757        261      139609.007                      
Total         53319112.789        262                                      
---------------------------------------------------------------------------

                                    Parameter Estimates                                     
-------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t        Sig       lower      upper 
-------------------------------------------------------------------------------------------
(Intercept)    259.082        34.127                  7.592    0.000    191.882    326.282 
      CRuns      0.766         0.070        0.563    10.996    0.000      0.629      0.904 
-------------------------------------------------------------------------------------------



Stepwise Selection: Step 2 

- Hits added 

                          Model Summary                            
------------------------------------------------------------------
R                       0.644       RMSE                  346.429 
R-Squared               0.415       Coef. Var              64.641 
Adj. R-Squared          0.410       MSE                120013.306 
Pred R-Squared          0.389       MAE                   230.183 
------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                  ANOVA                                    
--------------------------------------------------------------------------
                    Sum of                                                
                   Squares         DF     Mean Square      F         Sig. 
--------------------------------------------------------------------------
Regression    22115653.209          2    11057826.604    92.138    0.0000 
Residual      31203459.580        260      120013.306                     
Total         53319112.789        262                                     
--------------------------------------------------------------------------

                                    Parameter Estimates                                     
-------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t        Sig        lower     upper 
-------------------------------------------------------------------------------------------
(Intercept)    -50.817        56.596                 -0.898    0.370    -162.262    60.627 
      CRuns      0.661         0.067        0.486     9.939    0.000       0.530     0.792 
       Hits      3.226         0.488        0.323     6.604    0.000       2.264     4.188 
-------------------------------------------------------------------------------------------

                          Model Summary                            
------------------------------------------------------------------
R                       0.644       RMSE                  346.429 
R-Squared               0.415       Coef. Var              64.641 
Adj. R-Squared          0.410       MSE                120013.306 
Pred R-Squared          0.389       MAE                   230.183 
------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                  ANOVA                                    
--------------------------------------------------------------------------
                    Sum of                                                
                   Squares         DF     Mean Square      F         Sig. 
--------------------------------------------------------------------------
Regression    22115653.209          2    11057826.604    92.138    0.0000 
Residual      31203459.580        260      120013.306                     
Total         53319112.789        262                                     
--------------------------------------------------------------------------

                                    Parameter Estimates                                     
-------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t        Sig        lower     upper 
-------------------------------------------------------------------------------------------
(Intercept)    -50.817        56.596                 -0.898    0.370    -162.262    60.627 
      CRuns      0.661         0.067        0.486     9.939    0.000       0.530     0.792 
       Hits      3.226         0.488        0.323     6.604    0.000       2.264     4.188 
-------------------------------------------------------------------------------------------



Stepwise Selection: Step 3 

- Walks added 

                          Model Summary                            
------------------------------------------------------------------
R                       0.655       RMSE                  342.936 
R-Squared               0.429       Coef. Var              63.990 
Adj. R-Squared          0.422       MSE                117605.308 
Pred R-Squared          0.398       MAE                   230.113 
------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                  ANOVA                                   
-------------------------------------------------------------------------
                    Sum of                                               
                   Squares         DF    Mean Square      F         Sig. 
-------------------------------------------------------------------------
Regression    22859338.083          3    7619779.361    64.791    0.0000 
Residual      30459774.706        259     117605.308                     
Total         53319112.789        262                                    
-------------------------------------------------------------------------

                                    Parameter Estimates                                     
-------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t        Sig        lower     upper 
-------------------------------------------------------------------------------------------
(Intercept)    -76.854        56.974                 -1.349    0.179    -189.045    35.337 
      CRuns      0.620         0.068        0.455     9.117    0.000       0.486     0.753 
       Hits      2.415         0.581        0.242     4.157    0.000       1.271     3.560 
      Walks      3.126         1.243        0.151     2.515    0.013       0.678     5.575 
-------------------------------------------------------------------------------------------

                          Model Summary                            
------------------------------------------------------------------
R                       0.655       RMSE                  342.936 
R-Squared               0.429       Coef. Var              63.990 
Adj. R-Squared          0.422       MSE                117605.308 
Pred R-Squared          0.398       MAE                   230.113 
------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                  ANOVA                                   
-------------------------------------------------------------------------
                    Sum of                                               
                   Squares         DF    Mean Square      F         Sig. 
-------------------------------------------------------------------------
Regression    22859338.083          3    7619779.361    64.791    0.0000 
Residual      30459774.706        259     117605.308                     
Total         53319112.789        262                                    
-------------------------------------------------------------------------

                                    Parameter Estimates                                     
-------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t        Sig        lower     upper 
-------------------------------------------------------------------------------------------
(Intercept)    -76.854        56.974                 -1.349    0.179    -189.045    35.337 
      CRuns      0.620         0.068        0.455     9.117    0.000       0.486     0.753 
       Hits      2.415         0.581        0.242     4.157    0.000       1.271     3.560 
      Walks      3.126         1.243        0.151     2.515    0.013       0.678     5.575 
-------------------------------------------------------------------------------------------



Stepwise Selection: Step 4 

- CWalks added 

                          Model Summary                            
------------------------------------------------------------------
R                       0.661       RMSE                  340.961 
R-Squared               0.437       Coef. Var              63.621 
Adj. R-Squared          0.429       MSE                116254.294 
Pred R-Squared          0.402       MAE                   229.259 
------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                  ANOVA                                   
-------------------------------------------------------------------------
                    Sum of                                               
                   Squares         DF    Mean Square      F         Sig. 
-------------------------------------------------------------------------
Regression    23325504.960          4    5831376.240    50.161    0.0000 
Residual      29993607.829        258     116254.294                     
Total         53319112.789        262                                    
-------------------------------------------------------------------------

                                    Parameter Estimates                                     
-------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t        Sig        lower     upper 
-------------------------------------------------------------------------------------------
(Intercept)    -63.651        57.028                 -1.116    0.265    -175.951    48.649 
      CRuns      1.022         0.212        0.751     4.818    0.000       0.604     1.440 
       Hits      1.569         0.716        0.157     2.192    0.029       0.160     2.979 
      Walks      5.058         1.568        0.244     3.226    0.001       1.971     8.146 
     CWalks     -0.564         0.282       -0.330    -2.002    0.046      -1.119    -0.009 
-------------------------------------------------------------------------------------------

                          Model Summary                            
------------------------------------------------------------------
R                       0.661       RMSE                  340.961 
R-Squared               0.437       Coef. Var              63.621 
Adj. R-Squared          0.429       MSE                116254.294 
Pred R-Squared          0.402       MAE                   229.259 
------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                  ANOVA                                   
-------------------------------------------------------------------------
                    Sum of                                               
                   Squares         DF    Mean Square      F         Sig. 
-------------------------------------------------------------------------
Regression    23325504.960          4    5831376.240    50.161    0.0000 
Residual      29993607.829        258     116254.294                     
Total         53319112.789        262                                    
-------------------------------------------------------------------------

                                    Parameter Estimates                                     
-------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t        Sig        lower     upper 
-------------------------------------------------------------------------------------------
(Intercept)    -63.651        57.028                 -1.116    0.265    -175.951    48.649 
      CRuns      1.022         0.212        0.751     4.818    0.000       0.604     1.440 
       Hits      1.569         0.716        0.157     2.192    0.029       0.160     2.979 
      Walks      5.058         1.568        0.244     3.226    0.001       1.971     8.146 
     CWalks     -0.564         0.282       -0.330    -2.002    0.046      -1.119    -0.009 
-------------------------------------------------------------------------------------------



No more variables to be added/removed.


Final Model Output 
------------------

                          Model Summary                            
------------------------------------------------------------------
R                       0.661       RMSE                  340.961 
R-Squared               0.437       Coef. Var              63.621 
Adj. R-Squared          0.429       MSE                116254.294 
Pred R-Squared          0.402       MAE                   229.259 
------------------------------------------------------------------
 RMSE: Root Mean Square Error 
 MSE: Mean Square Error 
 MAE: Mean Absolute Error 

                                  ANOVA                                   
-------------------------------------------------------------------------
                    Sum of                                               
                   Squares         DF    Mean Square      F         Sig. 
-------------------------------------------------------------------------
Regression    23325504.960          4    5831376.240    50.161    0.0000 
Residual      29993607.829        258     116254.294                     
Total         53319112.789        262                                    
-------------------------------------------------------------------------

                                    Parameter Estimates                                     
-------------------------------------------------------------------------------------------
      model       Beta    Std. Error    Std. Beta      t        Sig        lower     upper 
-------------------------------------------------------------------------------------------
(Intercept)    -63.651        57.028                 -1.116    0.265    -175.951    48.649 
      CRuns      1.022         0.212        0.751     4.818    0.000       0.604     1.440 
       Hits      1.569         0.716        0.157     2.192    0.029       0.160     2.979 
      Walks      5.058         1.568        0.244     3.226    0.001       1.971     8.146 
     CWalks     -0.564         0.282       -0.330    -2.002    0.046      -1.119    -0.009 
-------------------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
                               Stepwise Selection Summary                                
----------------------------------------------------------------------------------------
                     Added/                   Adj.                                          
Step    Variable    Removed     R-Square    R-Square     C(p)         AIC         RMSE      
----------------------------------------------------------------------------------------
   1     CRuns      addition       0.317       0.314    54.1400    3866.0101    373.6429    
   2      Hits      addition       0.415       0.410    11.1560    3827.2236    346.4294    
   3     Walks      addition       0.429       0.422     6.7650    3822.8795    342.9363    
   4     CWalks     addition       0.437       0.429     4.7590    3820.8233    340.9608    
----------------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
<section id="예-2.13-다중공선성" class="level4">
<h4 class="anchored" data-anchor-id="예-2.13-다중공선성">(예 2.13) 다중공선성</h4>
<p>분산팽창계수</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>vif_value1 <span class="ot">&lt;-</span> <span class="fu">vif</span>(lm_model)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>vif_value1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Hits     Walks     CRuns     HmRun    CWalks 
 2.626281  2.641472 11.132539  1.465358 12.496169 </code></pre>
</div>
</div>
<p>변수간 상관계수</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>vars1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Hits"</span>, <span class="st">"Walks"</span>, <span class="st">"CRuns"</span>, <span class="st">"HmRun"</span>, <span class="st">"CWalks"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dat_ba[vars1])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Hits     Walks     CRuns     HmRun    CWalks
Hits   1.0000000 0.6412106 0.2617869 0.5621579 0.1518182
Walks  0.6412106 1.0000000 0.3384780 0.4810143 0.4245071
CRuns  0.2617869 0.3384780 1.0000000 0.2623606 0.9278069
HmRun  0.5621579 0.4810143 0.2623606 1.0000000 0.2331537
CWalks 0.1518182 0.4245071 0.9278069 0.2331537 1.0000000</code></pre>
</div>
</div>
<p>상관계수가 높은 두 변수 간의 선형관계</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat_ba[, <span class="fu">c</span>(<span class="st">"CRuns"</span>, <span class="st">"CWalks"</span>)])</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(CWalks <span class="sc">~</span> CRuns, <span class="at">data =</span> dat_ba), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch02_regression_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>상관계수가 높은 두 변수 중 하나의 변수를 제거</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>lm2_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Salary <span class="sc">~</span> Hits <span class="sc">+</span> Walks <span class="sc">+</span> CRuns <span class="sc">+</span> HmRun, <span class="at">data =</span> dat_ba)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ Hits + Walks + CRuns + HmRun, data = dat_ba)

Residuals:
    Min      1Q  Median      3Q     Max 
-902.84 -189.20  -37.78  104.27 2196.70 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -75.27564   57.04814  -1.320 0.188168    
Hits          2.23021    0.62602   3.563 0.000437 ***
Walks         2.97024    1.25939   2.358 0.019096 *  
CRuns         0.61299    0.06849   8.950  &lt; 2e-16 ***
HmRun         2.33890    2.92909   0.799 0.425310    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 343.2 on 258 degrees of freedom
  (59 observations deleted due to missingness)
Multiple R-squared:  0.4301,    Adjusted R-squared:  0.4213 
F-statistic: 48.68 on 4 and 258 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>vif_value2 <span class="ot">&lt;-</span> <span class="fu">vif</span>(lm2_model)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>vif_value2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Hits    Walks    CRuns    HmRun 
1.775329 1.664286 1.144697 1.463700 </code></pre>
</div>
</div>
</section>
</section>
<section id="예-2.14-2.16" class="level2">
<h2 class="anchored" data-anchor-id="예-2.14-2.16">(예 2.14, 2.16)</h2>
<section id="패키지-로드-1" class="level4">
<h4 class="anchored" data-anchor-id="패키지-로드-1">패키지 로드</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="데이터-로드-2" class="level4">
<h4 class="anchored" data-anchor-id="데이터-로드-2">데이터 로드</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/ch2_coil.csv"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      temp           thick           y        
 Min.   :530.0   Min.   :2.0   Min.   :48.70  
 1st Qu.:562.5   1st Qu.:2.0   1st Qu.:49.52  
 Median :605.0   Median :6.0   Median :50.80  
 Mean   :616.0   Mean   :4.4   Mean   :50.54  
 3rd Qu.:675.0   3rd Qu.:6.0   3rd Qu.:51.27  
 Max.   :710.0   Max.   :6.0   Max.   :52.50  </code></pre>
</div>
</div>
</section>
<section id="지시변수-변환" class="level4">
<h4 class="anchored" data-anchor-id="지시변수-변환">지시변수 변환</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dat1<span class="sc">$</span>thick <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat1<span class="sc">$</span>thick, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">2</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      temp       thick       y        
 Min.   :530.0   6:6   Min.   :48.70  
 1st Qu.:562.5   2:4   1st Qu.:49.52  
 Median :605.0         Median :50.80  
 Mean   :616.0         Mean   :50.54  
 3rd Qu.:675.0         3rd Qu.:51.27  
 Max.   :710.0         Max.   :52.50  </code></pre>
</div>
</div>
</section>
<section id="예-2.14-회귀모형-추정" class="level4">
<h4 class="anchored" data-anchor-id="예-2.14-회귀모형-추정">(예 2.14) 회귀모형 추정</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> temp <span class="sc">+</span> thick, <span class="at">data =</span> dat1)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ temp + thick, data = dat1)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.26076 -0.18481 -0.02085  0.16208  0.29881 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 61.107966   0.703491  86.864 7.06e-12 ***
temp        -0.017678   0.001149 -15.380 1.18e-06 ***
thick2       0.804153   0.149570   5.376  0.00103 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.228 on 7 degrees of freedom
Multiple R-squared:  0.9721,    Adjusted R-squared:  0.9641 
F-statistic: 121.8 on 2 and 7 DF,  p-value: 3.641e-06</code></pre>
</div>
</div>
</section>
<section id="예-2.16-교호작용-추정" class="level4">
<h4 class="anchored" data-anchor-id="예-2.16-교호작용-추정">(예 2.16) 교호작용 추정</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>lm_fit_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> temp <span class="sc">+</span> thick <span class="sc">+</span> temp<span class="sc">:</span>thick, <span class="at">data =</span> dat1)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit_interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ temp + thick + temp:thick, data = dat1)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.18286 -0.10707 -0.02152  0.08831  0.30949 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 60.136402   0.749951  80.187 2.53e-10 ***
temp        -0.016076   0.001230 -13.074 1.23e-05 ***
thick2       3.278471   1.210446   2.708   0.0352 *  
temp:thick2 -0.003987   0.001940  -2.055   0.0857 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1886 on 6 degrees of freedom
Multiple R-squared:  0.9836,    Adjusted R-squared:  0.9754 
F-statistic:   120 on 3 and 6 DF,  p-value: 9.577e-06</code></pre>
</div>
</div>
<p>시각화</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat1, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> y, <span class="at">shape =</span> thick, <span class="at">linetype =</span> thick)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"X(temp)"</span>, <span class="at">y =</span> <span class="st">"Y"</span>, <span class="at">shape =</span> <span class="st">"thickness"</span>, <span class="at">linetype =</span> <span class="st">"thickness"</span>) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ch02_regression_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../index.html" class="pagination-link" aria-label="소개">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">소개</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/ch03_regularized_regression.html" class="pagination-link" aria-label="3장 규제 회귀분석">
        <span class="nav-page-text"><span class="chapter-title">3장 규제 회귀분석</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>